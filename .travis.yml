language: cpp

sudo: required

matrix:
  include:
    - env: EVAL="CXX=g++-5" FLAGS="-m32" CONFIG=Debug
      addons:
        apt:
          sources: ['ubuntu-toolchain-r-test']
          packages: ['g++-5-multilib', 'lib32stdc++6', 'linux-libc-dev']
    - env: EVAL="CXX=g++-5" FLAGS="-m32" CONFIG=Release
      addons:
        apt:
          sources: ['ubuntu-toolchain-r-test']
          packages: ['g++-5-multilib', 'lib32stdc++6', 'linux-libc-dev']
    - env: EVAL="CXX=g++-5" FLAGS="-m64" CONFIG=Debug
      addons:
        apt:
          sources: ['ubuntu-toolchain-r-test']
          packages: ['g++-5']
    - env: EVAL="CXX=g++-5" FLAGS="-m64" CONFIG=Release
      addons:
        apt:
          sources: ['ubuntu-toolchain-r-test']
          packages: ['g++-5']
    - env: EVAL="CXX=clang++" FLAGS="-m32" CONFIG=Debug
      addons:
        apt:
          sources: ['ubuntu-toolchain-r-test']
          packages: ['g++-5-multilib', 'lib32stdc++6', 'linux-libc-dev']
    - env: EVAL="CXX=clang++" FLAGS="-m32" CONFIG=Release
      addons:
        apt:
          sources: ['ubuntu-toolchain-r-test']
          packages: ['g++-5-multilib', 'lib32stdc++6', 'linux-libc-dev']
    - env: EVAL="CXX=clang++" FLAGS="-m64" CONFIG=Debug
      addons:
        apt:
          sources: ['ubuntu-toolchain-r-test']
          packages: ['g++-5']
    - env: EVAL="CXX=clang++" FLAGS="-m64" CONFIG=Release
      addons:
        apt:
          sources: ['ubuntu-toolchain-r-test']
          packages: ['g++-5']

before_script:
- sudo ln -s /usr/include/asm-generic /usr/include/asm
- eval "${EVAL}"
- $CXX -v
- cd ..
- git clone -q --branch=master https://github.com/SuperSodaSea/Corecat.git
- cd Corecat
- git checkout -fq master
- cp -r include ../Textcat
- cd ../Textcat
- cmake -H. -Bbuild -DCMAKE_CXX_COMPILER=$CXX -DCMAKE_CXX_FLAGS=$FLAGS -DCMAKE_BUILD_TYPE=$CONFIG

script:
- make -C build

after_success:
- ./build/XML_DOMReader data/test1.xml
- ./build/XML_DOMWriter
- ./build/XML_SAXReader data/test1.xml
- ./build/XML_SAXWriter
